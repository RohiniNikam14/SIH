const translations = {
  en: {
    title: "MIGRANTcare",
    subtitle: "Health Record Management",
    loginTitle: "Login - MigrantCare",
    loginHeader: "Login",
    registrationId: "Registration ID",
    enterRegId: "Enter Registration ID",
    loginBtn: "Login",
    noAccount: "Don't have an account? ",
    registerHere: "Register here",
    selectLanguage: "Select Language:",
    signupBtn: "New Registration",
    welcomeText: "Welcome to MIGRANTcare – Your Health, Managed",
    medicalHistory: "Medical History",
    prescription: "Prescription",
    testsLabRecords: "Tests/ Lab Records",
    doctorSuggestions: "Doctor Suggestions",
    termsConditions: "Terms & Conditions",
    privacyPolicy: "Privacy Policy",
    contactUs: "Contact Us",
    signupTitle: "Signup",
    patientName: "Patient Name",
    age: "Age",
    bloodGroup: "Blood Group",
    height: "Height",
    weight: "Weight",
    currentDisease: "Currently Suffering Disease",
    mobileNumber: "Mobile Number",
    permanentAddress: "Permanent Address",
    currentAddress: "Current Address",
    generateIdBtn: "Generate Your ID",
    loginEmptyMsg:"Please enter your Registration ID.",
    loginSuccessMsg:"Login successful!",
    loginInvalidMsg:"Invalid Registration ID. Please try again."
  },
  hi: {
    title: "[translate:माइग्रेंटकेयर]",
    subtitle: "[translate:स्वास्थ्य रिकॉर्ड प्रबंधन]",
    loginTitle: "[translate:लॉगिन - माइग्रेंटकेयर]",
    loginHeader: "[translate:लॉगिन करें]",
    registrationId: "[translate:पंजीकरण आईडी]",
    enterRegId: "[translate:पंजीकरण आईडी दर्ज करें]",
    loginBtn: "[translate:लॉगिन]",
    noAccount: "[translate:क्या आपके पास खाता नहीं है? ]",
    registerHere: "[translate:यहाँ पंजीकरण करें]",
    selectLanguage: "[translate:भाषा चुनें:]",
    signupBtn: "[translate:नई पंजीकरण]",
    welcomeText: "[translate:माइग्रेंटकेयर में आपका स्वागत है – आपका स्वास्थ्य, प्रबंधित]",
    medicalHistory: "[translate:चिकित्सा इतिहास]",
    prescription: "[translate:प्रिस्क्रिप्शन]",
    testsLabRecords: "[translate:परीक्षण / प्रयोगशाला रिकॉर्ड]",
    doctorSuggestions: "[translate:डॉक्टर सुझाव]",
    termsConditions: "[translate:नियम और शर्तें]",
    privacyPolicy: "[translate:गोपनीयता नीति]",
    contactUs: "[translate:संपर्क करें]",
    signupTitle: "[translate:पंजीकरण करें]",
    patientName: "[translate:मरीज का नाम]",
    age: "[translate:आयु]",
    bloodGroup: "[translate:रक्त समूह]",
    height: "[translate:ऊंचाई]",
    weight: "[translate:वजन]",
    currentDisease: "[translate:वर्तमान रोग]",
    mobileNumber: "[translate:मोबाइल नंबर]",
    permanentAddress: "[translate:स्थायी पता]",
    currentAddress: "[translate:वर्तमान पता]",
    generateIdBtn: "[translate:अपना आईडी जनरेट करें]",
    loginEmptyMsg:"[translate:कृपया अपनी पंजीकरण आईडी दर्ज करें।]",
    loginSuccessMsg:"[translate:लॉगिन सफलतापूर्ण!]",
    loginInvalidMsg:"[translate:अमान्य पंजीकरण आईडी। कृपया पुनः प्रयास करें।]"
  },
  te: {
    title: "[translate:మైగ్రాంట్‌కేర్]",
    subtitle: "[translate:ఆరోగ్య రికార్డ్ నిర్వహణ]",
    loginTitle: "[translate:లాగిన్ - మైగ్రాంట్‌కేర్]",
    loginHeader: "[translate:లాగిన్]",
    registrationId: "[translate:నమోదు ID]",
    enterRegId: "[translate:నమోదు ID ఎంటర్ చేయండి]",
    loginBtn: "[translate:లాగిన్]",
    noAccount: "[translate:మీ వద్ద ఖాతా లేదు? ]",
    registerHere: "[translate:ఇక్కడ నమోదు చేసుకోండి]",
    selectLanguage: "[translate:భాషను ఎంచుకోండి:]",
    signupBtn: "[translate:కొత్త నమోదు]",
    welcomeText: "[translate:మైగ్రాంట్‌కేర్ కు స్వాగతం - మీ ఆరోగ్యం, నిర్వహించబడింది]",
    medicalHistory: "[translate:వైద్య చరిత్ర]",
    prescription: "[translate:ప్రిస్క్రిప్షన్]",
    testsLabRecords: "[translate:పరీక్షలు / ప్రయోగశాల రికార్డులు]",
    doctorSuggestions: "[translate:డాక్టర్ సూచనలు]",
    termsConditions: "[translate:నియమాలు & షరతులు]",
    privacyPolicy: "[translate:గోప్యతా విధానం]",
    contactUs: "[translate:మమ్మల్ని సంప్రదించండి]",
    signupTitle: "[translate:సైన్ అప్]",
    patientName: "[translate:రోగి పేరు]",
    age: "[translate:వయస్సు]",
    bloodGroup: "[translate:రక్త సమూహం]",
    height: "[translate:ఎత్తు]",
    weight: "[translate:బరువు]",
    currentDisease: "[translate:ప్రస్తుతం బాధపడుతున్న వ్యాధి]",
    mobileNumber: "[translate:మొబైల్ నంబర్]",
    permanentAddress: "[translate:స్థిర చిరునామా]",
    currentAddress: "[translate:ప్రస్తుత చిరునామా]",
    generateIdBtn: "[translate:మీ ID సృష్టించండి]",
    loginEmptyMsg:"[translate:దయచేసి మీ నమోదు ID నమోదు చేయండి.]",
    loginSuccessMsg:"[translate:లాగిన్ విజయవంతంగా జరిగింది!]",
    loginInvalidMsg:"[translate:చెల్లని నమోదు ID. దయచేసి మళ్లీ ప్రయత్నించండి.]"
  },
  ml: {
    title: "[translate:മൈഗ്രാന്റ്കെയർ]",
    subtitle: "[translate:ആരോഗ്യ രേഖാ ക്രമീകരണം]",
    loginTitle: "[translate:ലോഗിൻ - മൈഗ്രാന്റ്കെയർ]",
    loginHeader: "[translate:ലോഗിൻ]",
    registrationId: "[translate:രജിസ്ട്രേഷൻ ഐഡി]",
    enterRegId: "[translate:രജിസ്ട്രേഷൻ ഐഡി നൽകുക]",
    loginBtn: "[translate:ലോഗിൻ]",
    noAccount: "[translate:നിങ്ങൾക്കൊരു അക്കൗണ്ട് ഇല്ലേ? ]",
    registerHere: "[translate:ഇവിടെ രജിസ്റ്റർ ചെയ്യുക]",
    selectLanguage: "[translate:ഭാഷ തിരഞ്ഞെടുക്കുക:]",
    signupBtn: "[translate:പുതിയ രജിസ്‌ട്രേഷൻ]",
    welcomeText: "[translate:മൈഗ്രാന്റ്കെയറിൽ സ്വാഗതം - നിങ്ങളുടെ ആരോഗ്യം, മാനേജുചെയ்த്തു]",
    medicalHistory: "[translate:മെഡിക്കൽ ചരിത്രം]",
    prescription: "[translate:പ്രിസ്ക്രിപ്ഷൻ]",
    testsLabRecords: "[translate:ടെസ്റ്റുകൾ / ലാബ് രേഖകൾ]",
    doctorSuggestions: "[translate:ഡോക്ടർ നിർദ്ദേശങ്ങൾ]",
    termsConditions: "[translate:നിയമങ്ങളും നിബന്ധനകളും]",
    privacyPolicy: "[translate:സ്വകാര്യതാ നയം]",
    contactUs: "[translate:ഞങ്ങളുമായി ബന്ധപ്പെടുക]",
    signupTitle: "[translate:സൈൻ അപ്പ്]",
    patientName: "[translate:രോഗിയുടെ പേര്]",
    age: "[translate:വയസ്സ്]",
    bloodGroup: "[translate:രക്ത ഗ്രൂപ്പ്]",
    height: "[translate:ഏതരം]",
    weight: "[translate:ഭാരം]",
    currentDisease: "[translate:ഇപ്പോൾ ബാധിക്കുന്നത് രോഗം]",
    mobileNumber: "[translate:മൊബൈൽ നമ്പർ]",
    permanentAddress: "[translate:സ്ഥിരമായ വിലാസം]",
    currentAddress: "[translate:ഇപ്പോൾ വിലാസം]",
    generateIdBtn: "[translate:നിങ്ങളുടെ ഐഡി സൃഷ്ടിക്കുക]",
    loginEmptyMsg:"[translate:ദയവായി നിങ്ങളുടെ രജിസ്ട്രേഷൻ ഐഡി നൽകുക.]",
    loginSuccessMsg:"[translate:ലോഗിൻ വിജയകരമായി!]",
    loginInvalidMsg:"[translate:അസാധുവായ രജിസ്ട്രേഷൻ ഐഡി. ദയവായി വീണ്ടും ശ്രമിക്കുക.]"
  },
  kn: {
    title: "[translate:ಮೈಗ್ರMigrANTಕೆಮೈಂಟ್]",
    subtitle: "[translate:ಆರೋಗ್ಯ ದಾಖಲೆ ನಿರ್ವಹಣೆ]",
    loginTitle: "[translate:ಲಾಗಿನ್ - ಮೈಗ್ರMigrANTಕೆಮೈಂಟ್]",
    loginHeader: "[translate:ಲಾಗಿನ್]",
    registrationId: "[translate:ನೋಂದಣಿ ID]",
    enterRegId: "[translate:ನೋಂದಣಿ ID ನಮೂದಿಸಿ]",
    loginBtn: "[translate:ಲಾಗಿನ್]",
    noAccount: "[translate:ನಿಮ್ಮಲ್ಲಿ ಖಾತೆಯಿಲ್ಲವೇ? ]",
    registerHere: "[translate:ಇಲ್ಲಿ ನೋಂದಣಿ ಮಾಡಿ]",
    selectLanguage: "[translate:ಭಾಷೆಯನ್ನು ಆರಿಸಿ:]",
    signupBtn: "[translate:ಹೊಸ ನೋಂದಣಿ]",
    welcomeText: "[translate:ಮೈಗ್ರMigrANTಕೆಮೈಂಟ್ ಗೆ ಸ್ವಾಗತ - ನಿಮ್ಮ ಆರೋಗ್ಯ, ನಿರ್ವಹಣೆ]",
    medicalHistory: "[translate:ವೈದ್ಯಕೀಯ ಇತಿಹಾಸ]",
    prescription: "[translate:ಪ್ರಿಸ್ಕ್ರಿಪ್ಷನ್]",
    testsLabRecords: "[translate:ಪರೀಕ್ಷೆಗಳು / ಲ್ಯಾಬ್ ದಾಖಲೆಗಳು]",
    doctorSuggestions: "[translate:ಡಾಕ್ಟರ್ ಸಲಹೆಗಳು]",
    termsConditions: "[translate:ನಿಯಮಗಳು ಮತ್ತು ಶರತ್ತುಗಳು]",
    privacyPolicy: "[translate:ಗೌಪ್ಯತಾ ನೀತಿ]",
    contactUs: "[translate:ನಮ್ಮನ್ನು ಸಂಪರ್ಕಿಸಿ]",
    signupTitle: "[translate:ಸೈನ್ ಅಪ್]",
    patientName: "[translate:ರೋಗಿಯ ಹೆಸರು]",
    age: "[translate:ವಯಸ್ಸು]",
    bloodGroup: "[translate:ರಕ್ತ ಗುಂಪು]",
    height: "[translate:ಎತ್ತರ]",
    weight: "[translate:ತೂಕ]",
    currentDisease: "[translate:ಪ್ರಸ್ತುತ ರೋಗಂಟು]",
    mobileNumber: "[translate:ಮೊಬೈಲ್ ನಂಬರ್]",
    permanentAddress: "[translate:ಸ್ಥಿರ ವಿಳಾಸ]",
    currentAddress: "[translate:ಪ್ರಸ್ತುತ ವಿಳಾಸ]",
    generateIdBtn: "[translate:ನಿಮ್ಮ ID ರಚಿಸಿ]",
    loginEmptyMsg:"[translate:ದಯವಿಟ್ಟು ನಿಮ್ಮ ನೋಂದಣಿ ID ನಮೂದಿಸಿ.]",
    loginSuccessMsg:"[translate:ಲಾಗಿನ್ ಯಶಸ್ವಿಯಾದ್ದು!]",
    loginInvalidMsg:"[translate:ತಪ್ಪಾದ ನೋಂದಣಿ ID. ದಯವಿಟ್ಟು ಮರುಪ್ರಯತ್ನಿಸಿ.]"
  },
  mr: {
    title: "[translate:मायग्रंटकेअर]",
    subtitle: "[translate:आरोग्य रेकॉर्ड व्यवस्थापन]",
    loginTitle: "[translate:लॉगिन - मायग्रंटकेअर]",
    loginHeader: "[translate:लॉगिन]",
    registrationId: "[translate:नोंदणी आयडी]",
    enterRegId: "[translate:नोंदणी आयडी प्रविष्ट करा]",
    loginBtn: "[translate:लॉगिन]",
    noAccount: "[translate:तुमच्याकडे खाते नाही का? ]",
    registerHere: "[translate:येथे नोंदणी करा]",
    selectLanguage: "[translate:भाषा निवडा:]",
    signupBtn: "[translate:नवीन नोंदणी]",
    welcomeText: "[translate:मायग्रंटकेअर मध्ये आपले स्वागत आहे - आपले आरोग्य व्यवस्थापित]",
    medicalHistory: "[translate:वैद्यकीय इतिहास]",
    prescription: "[translate:प्रिस्क्रिप्शन]",
    testsLabRecords: "[translate:चाचण्या / लॅब नोंदी]",
    doctorSuggestions: "[translate:डॉक्टर सुचना]",
    termsConditions: "[translate:अटी व शर्ती]",
    privacyPolicy: "[translate:गोपनीयता धोरण]",
    contactUs: "[translate:आमच्याशी संपर्क साधा]",
    signupTitle: "[translate:नोंदणी]",
    patientName: "[translate:रुग्णाचे नाव]",
    age: "[translate:वय]",
    bloodGroup: "[translate:रक्तगट]",
    height: "[translate:उंची]",
    weight: "[translate:वजन]",
    currentDisease: "[translate:सध्या आजारी आहे]",
    mobileNumber: "[translate:मोबाईल नंबर]",
    permanentAddress: "[translate:कायमचे पत्ता]",
    currentAddress: "[translate:सध्याचा पत्ता]",
    generateIdBtn: "[translate:आपला आयडी तयार करा]",
    loginEmptyMsg:"[translate:कृपया आपला नोंदणी आयडी प्रविष्ट करा.]",
    loginSuccessMsg:"[translate:लॉगिन यशस्वी झाले!]",
    loginInvalidMsg:"[translate:अवैध नोंदणी आयडी. कृपया पुन्हा प्रयत्न करा.]"
  }
};

const nativeLanguageNames = {
  en: "English",
  hi: "[translate:हिन्दी]",
  te: "[translate:తెలుగు]",
  ml: "[translate:മലയാളം]",
  kn: "[translate:ಕನ್ನಡ]",
  mr: "[translate:मराठी]"
};

function updateTexts(lang) {
  document.querySelectorAll("[data-i18n]").forEach((el) => {
    const key = el.getAttribute("data-i18n");
    if (translations[lang] && translations[lang][key]) {
      el.textContent = translations[lang][key].replace(/^\[translate:(.*)\]$/, "$1");
    }
  });
  document.querySelectorAll("[data-i18n-placeholder]").forEach((el) => {
    const key = el.getAttribute("data-i18n-placeholder");
    if (translations[lang] && translations[lang][key]) {
      el.placeholder = translations[lang][key].replace(/^\[translate:(.*)\]$/, "$1");
    }
  });
  document.documentElement.lang = lang;
}

function changeLanguage(lang) {
  updateTexts(lang);
  localStorage.setItem("selectedLanguage", lang);
}

function applyPreferredLanguage() {
  const savedLang = localStorage.getItem("selectedLanguage") || (navigator.language ? navigator.language.split("-")[0] : "en");
  const lang = translations.hasOwnProperty(savedLang) ? savedLang : "en";
  const selectElem = document.getElementById("language");
  if (selectElem) {
    selectElem.innerHTML = Object.keys(translations)
      .map((l) => {
        let displayName = nativeLanguageNames[l] || l.toUpperCase();
        displayName = displayName.replace(/^\[translate:(.*)\]$/, "$1"); // remove [translate:] for display
        return `<option value="${l}">${displayName}</option>`;
      })
      .join("");
    selectElem.value = lang;
    selectElem.onchange = () => changeLanguage(selectElem.value);
  }
  updateTexts(lang);
}

window.addEventListener("DOMContentLoaded", applyPreferredLanguage);
